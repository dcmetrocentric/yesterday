<!doctype html>
<html lang="en">
<head>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=UnifrakturCook:wght@700&display=swap" rel="stylesheet">


  <!-- Social preview -->
  <meta property="og:title" content="Yesterday ‚Äî Guess the City">
  <meta property="og:description" content="Four clues. One city. Share your score and challenge friends.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://dcmetrocentric.github.io/yesterday//">
  <meta property="og:image" content="https://s.wordpress.com/mshots/v1/https%3A%2F%2Fdcmetrocentric.github.io%2Fyesterday%2F?w=1200">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Yesterday ‚Äî Guess the City">
  <meta name="twitter:description" content="Four clues. One city. Share your score and challenge friends.">
  <meta name="twitter:image" content="https://s.wordpress.com/mshots/v1/https%3A%2F%2Fdcmetrocentric.github.io%2Fyesterday%2F?w=1200">

<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Yesterday ‚Äî Guess the City</title>
<style>
:root{
  --bg:#F2F0EA;--card:#fff;--ink:#0F172A;--muted:#64748B;--line:#E7E2D8;--radius:20px;
}
*{box-sizing:border-box}
body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--ink);display:flex;justify-content:center;padding:14px 12px 24px}
.shell{width:min(820px,100%)}

/* Header */
.topbar{
  border-radius:var(--radius);
  border:1px solid var(--line);
  background:linear-gradient(135deg,rgba(31,78,121,.14),rgba(43,108,176,.08));
  padding:14px 14px 12px;
  display:flex;
  align-items:flex-end;
  justify-content:space-between;
  gap:12px;
  margin-bottom:10px;
}
.brandWrap{min-width:0}
.brand{font-weight:1000;letter-spacing:.05em;font-size:30px;line-height:1;margin:0}
.sub{margin:6px 0 0;font-size:13px;font-weight:760;color:rgba(15,23,42,.78)}
.rightMeta{text-align:right}
.metaLine{font-size:11px;color:var(--muted);font-weight:900}
.timer{margin-top:4px;font-weight:950;font-size:12px;color:rgba(15,23,42,.85)}

/* Card shell */
.card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);overflow:hidden}
.grid{padding:12px;display:grid;gap:10px;grid-template-columns:repeat(2,1fr)}
.flip{aspect-ratio:1/1;perspective:1200px}
.flipInner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .5s cubic-bezier(.2,.8,.2,1);cursor:pointer;border-radius:18px}
.flip[data-flipped="true"] .flipInner{transform:rotateY(180deg)}
.face{position:absolute;inset:0;border-radius:18px;overflow:hidden;border:1px solid var(--line);backface-visibility:hidden;background:#fff}
.front img{width:100%;height:100%;object-fit:cover;display:block}
.front .veil{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.04),rgba(0,0,0,.52))}
.front .tag{position:absolute;left:10px;top:10px;background:rgba(255,255,255,.92);padding:5px 9px;border-radius:999px;font-size:11px;font-weight:950}
.back{transform:rotateY(180deg);padding:12px;display:flex;align-items:center;justify-content:center;text-align:left}
.back p{margin:0;font-size:13px;line-height:1.45;font-weight:680;color:rgba(15,23,42,.92)}

/* Input */
.play{padding:12px;border-top:1px solid var(--line);background:rgba(242,240,234,.6)}
.play h2{margin:0 0 8px;font-size:12px;letter-spacing:.12em;text-transform:uppercase}
.row{display:flex;gap:8px;flex-wrap:wrap}
.inputWrap{flex:1;display:flex;align-items:center;background:#fff;border:1px solid var(--line);border-radius:12px;padding:8px 10px}
input{border:0;outline:none;width:100%;font-size:15px}
button{background:#0F172A;color:#fff;border:1px solid #0F172A;border-radius:12px;padding:10px 12px;font-weight:950}
button:disabled{opacity:.5}
.ghost{background:#fff;color:#0F172A;border:1px solid var(--line)}
.panel{margin-top:10px;padding:10px;border:1px solid var(--line);border-radius:14px;background:#fff}
.count{font-size:11px;color:var(--muted);font-weight:900;margin-top:6px}
.error{display:none;color:#7D2020;font-size:12px;margin-top:6px}

/* Modal (single-screen) */
.modal{position:fixed;inset:0;background:rgba(15,23,42,.55);display:none;align-items:center;justify-content:center;padding:14px}
.modal .box{
  width:min(760px,100%);
  background:#fff;border-radius:18px;border:1px solid var(--line);
  padding:14px;
  max-height:92vh;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.modalTop{display:flex;justify-content:space-between;align-items:baseline;gap:10px}
.modalTop h3{margin:0;font-size:20px}
.miniStats{font-size:12px;color:rgba(15,23,42,.8);font-weight:900}
.shareMini{
  font-family:ui-monospace,monospace;
  font-size:12px;
  white-space:pre-wrap;
  border:1px solid var(--line);
  background:#f7f6f2;
  border-radius:12px;
  padding:8px;
  line-height:1.25;
}
.paper{
  border:1px solid var(--line);
  border-radius:14px;
  overflow:hidden;
}
.paperHead{display:flex;justify-content:space-between;align-items:baseline;gap:10px;padding:8px 10px;background:rgba(242,240,234,.7);border-bottom:1px solid var(--line)}
.paperHead b{letter-spacing:.12em;text-transform:uppercase;font-size:11px}
.paperHead span{font-size:11px;color:var(--muted);font-weight:900}
.stories{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;padding:10px;background:#fff}
.story{border:1px solid var(--line);border-radius:14px;overflow:hidden;background:#fff}
.storyImg{height:78px;background:#eee}
.storyImg img{width:100%;height:100%;object-fit:cover;display:block}
.storyBody{padding:9px}
.storyTitle{font-weight:950;font-size:12.5px;line-height:1.2;margin:0 0 5px}
.storyMeta{font-size:11px;color:var(--muted);font-weight:900}
.story a{color:inherit;text-decoration:none}
.story a:hover{text-decoration:underline}
.modalBtns{display:flex;gap:8px;justify-content:flex-end}
@media (max-width:420px){
  .brand{font-size:28px}
  .stories{gap:7px}
  .storyImg{height:70px}
  .storyTitle{font-size:12px}
}

.card-front img, .fp-card img{
  display:block !important;
  width:100% !important;
  height:100% !important;
  object-fit:cover !important;
}


.emojiFront{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:88px;line-height:1;}


/* --- Mobile polish: centered layout + no horizontal scroll anywhere --- */
html, body { width:100%; overflow-x:hidden; }
*, *::before, *::after { box-sizing:border-box; }

@media (max-width: 520px){
  /* Center the whole game on phone with a touch more right padding */
  body{ padding-left:16px !important; padding-right:18px !important; }
  .shell, .wrap, .container, .main { width:100% !important; max-width: 520px !important; margin: 0 auto !important; }
}

/* Modal sizing: never require left/right scrolling */
.modal, .dialog, .sheet, .overlay .panel{
  max-width: 720px;
  width: min(720px, 94vw);
}
@media (max-width: 520px){
  .modal, .dialog, .sheet, .overlay .panel{
    width: 94vw !important;
    max-width: 94vw !important;
    margin-left:auto !important;
    margin-right:auto !important;
  }
  .modal * { max-width: 100%; }
}

/* Front page grid: collapse to one column on small screens to avoid side scroll */
@media (max-width: 520px){
  .frontpage, .fp-grid, .front-grid, .storiesGrid, .stories-grid{
    display:grid !important;
    grid-template-columns: 1fr !important;
    gap: 12px !important;
  }
}

/* Ensure any fixed-width tiles/images never overflow */
img{ max-width:100%; height:auto; }


/* --- Modal centering + mobile front page grid --- */
.modal{padding:14px 18px;}
.box{margin:0 auto; overflow-y:auto;}
@media (max-width: 520px){
  .box{width:94vw; max-width:94vw; }
  .stories{grid-template-columns:1fr;}
}


/* --- Modal centering + compact mobile (no sideways scroll) --- */
html, body { overflow-x: hidden; }
.overlay { display:flex; align-items:center; justify-content:center; padding:14px; }
.overlay .panel, .modal, .dialog { margin:0 auto; }

@media (max-width: 520px){
  body { padding-left:16px !important; padding-right:22px !important; }
  .overlay { padding:10px; }
  .overlay .panel, .modal, .dialog, .sheet { width: 94vw !important; max-width: 94vw !important; }
  /* Front Page back to 2x2 grid, compact tiles */
  .frontpage, .fp-grid, .front-grid, .storiesGrid, .stories-grid {
    grid-template-columns: 1fr 1fr !important;
    gap: 10px !important;
  }
  img{ max-width:100%; height:auto; }
  /* Make tiles shorter so popup fits without scrolling sideways */
  .fp-card img, .storyCard img, .story-tile img { height: 82px !important; object-fit: cover !important; }
  .fp-card .title, .storyCard .title, .story-tile .title { font-size: 14px !important; line-height: 1.15 !important; }
  .fp-card .src, .storyCard .src, .story-tile .src { font-size: 12px !important; }
  .overlay .panel { max-height: 92vh; overflow-y: auto; overflow-x: hidden; }
}


/* Answer emphasis */
#answerLine{font-weight:800;font-size:16px;}


/* Front Page titles-only list */
.fpList{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;}
@media (max-width:520px){ .fpList{gap:10px;} }
.fpItem{padding:10px;border:1px solid rgba(0,0,0,.10);border-radius:14px;background:#fff;}
.fpItem a{text-decoration:none;color:inherit;display:block;}
.fpTitle{font-family:Georgia,"Times New Roman",Times,serif;font-weight:700;font-size:15px;line-height:1.15;}
.fpSource{margin-top:6px;font-size:12px;opacity:.75;}


/* Gothic newspaper headlines */
.fpTitle{
  text-transform: uppercase;
  font-family: 'Cinzel','UnifrakturCook', Georgia, 'Times New Roman', serif !important;
  letter-spacing: 0.6px;
}

</style>
</head>
<body>
<div class="shell">

  <div class="topbar">
    <div class="brandWrap">
      <div class="brand">YESTERDAY</div>
      <div class="sub">What city was this?</div>
    </div>
    <div class="rightMeta">
      <div class="metaLine" id="puzzleId"></div>
      <div class="timer" id="timer"></div>
    </div>
  </div>

  <div class="card">
    <div class="grid" id="grid"></div>

    <div class="play">
      <h2>Guess the city</h2>
      <div class="row">
        <div class="inputWrap">
          <input id="guessInput" placeholder="Type a city" autocomplete="off" list="citylist">
          <datalist id="citylist"></datalist>
        </div>
        <button id="submitBtn">Submit</button>
        <button class="ghost" id="revealBtn">Reveal</button>
      </div>
      <div class="count" id="count">0/5 guesses</div>
      <div class="error" id="error">Unknown city. Try a major city (e.g., Boston, Los Angeles).</div>
      <div class="panel" id="feedback" style="display:none"></div>
    </div>
  </div>

</div>

<div class="modal" id="modal">
  <div class="box">
    <div class="modalTop">
      <h3 id="resultTitle">Solved!</h3>
      <div class="miniStats" id="miniStats"></div>
    </div>

    <div class="shareMini" id="shareBox"></div>

    <div class="paper">
      <div class="paperHead">
        <b>Yesterday‚Äôs Front Page</b>
        <span id="answerLine"></span>
      </div>
      <div class="stories" id="stories" class="fpList"></div>
    </div>

    <div class="modalBtns">
      <button id="shareBtn">Share</button>
      <button class="ghost" onclick="location.reload()">Close</button>
    </div>
  </div>
</div>

<script>

  function buildShareText(){
    try {
      const dayLabel = (typeof dayKey !== "undefined") ? dayKey : "";
      const emojisLine = (typeof currentPack !== "undefined" && currentPack?.cards)
        ? currentPack.cards.map(c=>c.emoji||"").join("")
        : "";
      const gridLine = (typeof guessGrid !== "undefined") ? guessGrid : "";
      const solvedLine = (typeof solved !== "undefined" && solved)
        ? `Solved ${guesses}/5`
        : `Revealed ${guesses}/5`;
      return `YESTERDAY  ${dayLabel}
${emojisLine}
${gridLine}
${solvedLine}
https://dcmetrocentric.github.io/yesterday/`;
    } catch(e) {
      return `YESTERDAY
https://dcmetrocentric.github.io/yesterday/`;
    }
  }


  function storyImage(city, headline, i){
    const q = encodeURIComponent((city + " " + (headline||"")).replace(/[^a-zA-Z0-9\s]/g," ").trim());
    return `https://source.unsplash.com/featured/800x500?${q}`;
  }
  function storyImageFallback(city, headline, i){
    const seed = encodeURIComponent((city + "|" + (headline||"") + "|" + i).slice(0,120));
    return `https://picsum.photos/seed/${seed}/800/500`;
  }

function previewImage(url){
  return `https://s.wordpress.com/mshots/v1/${encodeURIComponent(url)}?w=900`;
}

  async function resolvePreviewFromGoogleNewsSearch(searchUrl){
    try{
      const rssUrl = searchUrl.replace("https://news.google.com/search?", "https://news.google.com/rss/search?");
      const proxy = "https://r.jina.ai/" + rssUrl;
      const txt = await fetch(proxy, {cache:"force-cache"}).then(r=>r.text());
      const m1 = txt.match(/media:content[^>]*url="([^"]+)"/i);
      if(m1 && m1[1]) return {img:m1[1], link:null};
      const m2 = txt.match(/<item>[\s\S]*?<link>([^<]+)<\/link>/i);
      if(m2 && m2[1]){
        const link = m2[1].trim();
        return {img:previewImage(link), link};
      }
    }catch(e){}
    return {img:previewImage(searchUrl), link:null};
  }

  async function hydrateFrontPageImages(){
    const tiles = Array.from(document.querySelectorAll(".story"));
    await Promise.all(tiles.map(async (tile)=>{
      const a = tile.querySelector("a");
      const img = tile.querySelector("img");
      if(!a || !img) return;
      const url = a.getAttribute("href") || "";
      if(img.dataset.hydrated === "1") return;
      const res = await resolvePreviewFromGoogleNewsSearch(url);
      img.src = res.img;
      img.dataset.hydrated = "1";
      if(res.link) a.href = res.link;
    }));
  }

// --- Image resolver (no fetch, works from local file) ---
  const _imgCache = new Map(); // key -> chosen url
  function imgCandidates(tags, seed){
    const t = (tags || "").toString().trim().replace(/\s+/g," ").replace(/,+/g,",").replace(/^,|,$/g,"");
    const encTags = encodeURIComponent(t.replace(/ /g,","));
    const encSeed = encodeURIComponent(seed);
    return [
      `https://loremflickr.com/900/900/${encTags}?lock=${encSeed}`,
      `https://source.unsplash.com/900x900/?${encTags}`,
      `https://picsum.photos/seed/${encSeed}/900`
    ];
  }
  function resolveImg(key, tags, seed){
    if (_imgCache.has(key)) return Promise.resolve(_imgCache.get(key));
    return new Promise((resolve) => {
      const cands = imgCandidates(tags, seed);
      let i = 0;
      const probe = () => {
        const url = cands[i] || cands[cands.length-1];
        const im = new Image();
        im.referrerPolicy = "no-referrer";
        im.onload = () => { _imgCache.set(key, url); resolve(url); };
        im.onerror = () => { i++; probe(); };
        im.src = url;
      };
      probe();
    });
  }

  function setSmartImg(imgEl, key, tags, seed){
    imgEl.loading = "lazy";
    imgEl.decoding = "async";
    imgEl.referrerPolicy = "no-referrer";
    imgEl.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='900' height='900'%3E%3Crect width='900' height='900' fill='%23d9dde3'/%3E%3C/svg%3E";
    resolveImg(key, tags, seed).then(url => { imgEl.src = url; });
  }


// ----- date + countdown -----
const now = new Date();
const dayKey = now.toISOString().slice(0,10);
document.getElementById('puzzleId').textContent = "Puzzle " + dayKey;

function nextMidnight(){
  const n=new Date(); n.setHours(24,0,0,0); return n;
}
function tick(){
  const diff = nextMidnight() - new Date();
  const h=Math.floor(diff/3600000), m=Math.floor((diff%3600000)/60000), s=Math.floor((diff%60000)/1000);
  document.getElementById('timer').textContent = `Next puzzle in ${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}
setInterval(tick,1000); tick();

// stable hash -> int
function hashDate(key){
  let h=5381;
  for (let i=0;i<key.length;i++) h=((h<<5)+h)+key.charCodeAt(i);
  return (h>>>0);
}
function makeRand(seed){
  let s = seed>>>0;
  return function(){
    s = (1664525*s + 1013904223) >>> 0;
    return s / 4294967296;
  }
}

// ----- Images: use upload.wikimedia.org (direct) for best reliability -----
function wikimediaUpload(path){ return "https://upload.wikimedia.org/wikipedia/commons/" + path; }
const FALLBACK = "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 800'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop stop-color='%231F4E79'/><stop offset='1' stop-color='%232B6CB0'/></linearGradient></defs><rect width='800' height='800' fill='url(%23g)'/></svg>";

// ----- Guessable cities (expanded) -----
const CITIES=[
  {name:"New York",lat:40.7128,lng:-74.0060},{name:"Los Angeles",lat:34.0522,lng:-118.2437},{name:"Chicago",lat:41.8781,lng:-87.6298},
  {name:"Houston",lat:29.7604,lng:-95.3698},{name:"Phoenix",lat:33.4484,lng:-112.0740},{name:"Philadelphia",lat:39.9526,lng:-75.1652},
  {name:"San Antonio",lat:29.4241,lng:-98.4936},{name:"San Diego",lat:32.7157,lng:-117.1611},{name:"Dallas",lat:32.7767,lng:-96.7970},
  {name:"San Jose",lat:37.3382,lng:-121.8863},{name:"Austin",lat:30.2672,lng:-97.7431},{name:"Jacksonville",lat:30.3322,lng:-81.6557},
  {name:"Fort Worth",lat:32.7555,lng:-97.3308},{name:"Columbus",lat:39.9612,lng:-82.9988},{name:"Charlotte",lat:35.2271,lng:-80.8431},
  {name:"San Francisco",lat:37.7749,lng:-122.4194},{name:"Indianapolis",lat:39.7684,lng:-86.1581},{name:"Seattle",lat:47.6062,lng:-122.3321},
  {name:"Denver",lat:39.7392,lng:-104.9903},{name:"Washington",lat:38.9072,lng:-77.0369},{name:"Boston",lat:42.3601,lng:-71.0589},
  {name:"Nashville",lat:36.1627,lng:-86.7816},{name:"Detroit",lat:42.3314,lng:-83.0458},{name:"Portland",lat:45.5152,lng:-122.6784},
  {name:"Las Vegas",lat:36.1699,lng:-115.1398},{name:"Baltimore",lat:39.2904,lng:-76.6122},{name:"Milwaukee",lat:43.0389,lng:-87.9065},
  {name:"Sacramento",lat:38.5816,lng:-121.4944},{name:"Atlanta",lat:33.7490,lng:-84.3880},{name:"Kansas City",lat:39.0997,lng:-94.5786},
  {name:"Miami",lat:25.7617,lng:-80.1918},{name:"Raleigh",lat:35.7796,lng:-78.6382},{name:"Minneapolis",lat:44.9778,lng:-93.2650},
  {name:"New Orleans",lat:29.9511,lng:-90.0715},{name:"Cleveland",lat:41.4993,lng:-81.6944},{name:"Tampa",lat:27.9506,lng:-82.4572},
  {name:"Orlando",lat:28.5383,lng:-81.3792},{name:"Pittsburgh",lat:40.4406,lng:-79.9959},{name:"Cincinnati",lat:39.1031,lng:-84.5120},
  {name:"St. Louis",lat:38.6270,lng:-90.1994},{name:"Salt Lake City",lat:40.7608,lng:-111.8910},{name:"Honolulu",lat:21.3069,lng:-157.8583},
  {name:"Richmond",lat:37.5407,lng:-77.4360},{name:"Buffalo",lat:42.8864,lng:-78.8784},
  // Global majors
  {name:"Toronto",lat:43.6532,lng:-79.3832},{name:"Vancouver",lat:49.2827,lng:-123.1207},{name:"Montreal",lat:45.5017,lng:-73.5673},
  {name:"London",lat:51.5074,lng:-0.1278},{name:"Paris",lat:48.8566,lng:2.3522},{name:"Berlin",lat:52.52,lng:13.405},{name:"Rome",lat:41.9028,lng:12.4964},
  {name:"Madrid",lat:40.4168,lng:-3.7038},{name:"Barcelona",lat:41.3874,lng:2.1686},{name:"Amsterdam",lat:52.3676,lng:4.9041},
  {name:"Tokyo",lat:35.6762,lng:139.6503},{name:"Seoul",lat:37.5665,lng:126.9780},{name:"Singapore",lat:1.3521,lng:103.8198},
  {name:"Hong Kong",lat:22.3193,lng:114.1694},{name:"Sydney",lat:-33.8688,lng:151.2093},{name:"Melbourne",lat:-37.8136,lng:144.9631},
  {name:"Mexico City",lat:19.4326,lng:-99.1332},{name:"Sao Paulo",lat:-23.5558,lng:-46.6396},{name:"Buenos Aires",lat:-34.6037,lng:-58.3816}
];

// Autocomplete list (full city list)
const dl = document.getElementById("citylist");
if (dl){
  CITIES.forEach(c=>{ const o=document.createElement("option"); o.value=c.name; dl.appendChild(o); });
}

// aliases to reduce "unknown city"
const ALIASES = {
  "dc":"Washington","d.c.":"Washington","washington dc":"Washington",
  "sf":"San Francisco","san fran":"San Francisco","san fran.":"San Francisco",
  "nyc":"New York","new york city":"New York",
  "la":"Los Angeles","l.a.":"Los Angeles"
};

// ----- City packs (answer set) -----
// Each pack includes 4 city-related cards + 4 city-related "front page" stories.
// Images are direct upload.wikimedia.org paths (high reliability).
const CITY_PACKS = [
  {
    city:"Boston",
    lat:42.3601,lng:-71.0589,
    cards:[
      {emoji:"‚öæÔ∏è", clue:"Yesterday, a historic ballpark buzzed as fans packed in for a night game."},
      {emoji:"üöá", clue:"Yesterday, transit alerts turned a routine commute into a wait‚Äëand‚Äëwatch morning."},
      {emoji:"üéì", clue:"Yesterday, campus news drew attention across the academic corridor."},
      {emoji:"üßÅ", clue:"Yesterday, a sweet staple had a fresh twist and a line out the door."}
    ],
    stories:[
      {headline:"a historic ballpark buzzed as fans packed in for a night game.", source:"Google News", url:"https://news.google.com/search?q=Fenway%20Park%20crowd%20night%20game%20Boston%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"transit alerts turned a routine commute into a wait‚Äëand‚Äëwatch morning.", source:"Google News", url:"https://news.google.com/search?q=MBTA%20delays%20commuter%20alerts%20Boston%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"campus news drew attention across the academic corridor.", source:"Google News", url:"https://news.google.com/search?q=Harvard%20Cambridge%20campus%20news%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a sweet staple had a fresh twist and a line out the door.", source:"Google News", url:"https://news.google.com/search?q=Boston%20bakery%20new%20opening%20trend%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"New York",
    lat:40.7128,lng:-74.006,
    cards:[
      {emoji:"üöá", clue:"Yesterday, riders tracked service changes as trains slowed between stops."},
      {emoji:"üßë‚Äç‚öñÔ∏è", clue:"Yesterday, a courthouse calendar kept the city‚Äôs news cycle moving."},
      {emoji:"üé≠", clue:"Yesterday, a marquee performance pulled crowds into the theater district."},
      {emoji:"üóΩ", clue:"Yesterday, waterfront updates reshaped visitor plans."}
    ],
    stories:[
      {headline:"riders tracked service changes as trains slowed between stops.", source:"Google News", url:"https://news.google.com/search?q=NYC%20subway%20delays%20service%20change%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a courthouse calendar kept the city‚Äôs news cycle moving.", source:"Google News", url:"https://news.google.com/search?q=Manhattan%20court%20ruling%20latest%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a marquee performance pulled crowds into the theater district.", source:"Google News", url:"https://news.google.com/search?q=Broadway%20show%20opening%20audience%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"waterfront updates reshaped visitor plans.", source:"Google News", url:"https://news.google.com/search?q=NYC%20waterfront%20advisory%20ferry%20update%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Washington, DC",
    lat:38.9072,lng:-77.0369,
    cards:[
      {emoji:"üèõÔ∏è", clue:"Yesterday, negotiations and votes stretched late into the day downtown."},
      {emoji:"üõ´", clue:"Yesterday, airport boards flashed updates as schedules shifted."},
      {emoji:"üñºÔ∏è", clue:"Yesterday, a major exhibit drew crowds to a familiar museum row."},
      {emoji:"üö≤", clue:"Yesterday, a new mobility change stirred debate on the street."}
    ],
    stories:[
      {headline:"negotiations and votes stretched late into the day downtown.", source:"Google News", url:"https://news.google.com/search?q=Capitol%20Hill%20vote%20negotiations%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"airport boards flashed updates as schedules shifted.", source:"Google News", url:"https://news.google.com/search?q=DCA%20airport%20delays%20cancellations%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a major exhibit drew crowds to a familiar museum row.", source:"Google News", url:"https://news.google.com/search?q=Smithsonian%20exhibit%20opening%20crowd%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a new mobility change stirred debate on the street.", source:"Google News", url:"https://news.google.com/search?q=DC%20bike%20lane%20change%20debate%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Chicago",
    lat:41.8781,lng:-87.6298,
    cards:[
      {emoji:"ü´ò", clue:"Yesterday, a reflective landmark mirrored a midday crowd in the park."},
      {emoji:"üöÜ", clue:"Yesterday, commute plans changed fast after service notices went up."},
      {emoji:"üå¨Ô∏è", clue:"Yesterday, wind advisories put the lakefront in the headlines."},
      {emoji:"üçï", clue:"Yesterday, a neighborhood food story had locals talking."}
    ],
    stories:[
      {headline:"a reflective landmark mirrored a midday crowd in the park.", source:"Google News", url:"https://news.google.com/search?q=Cloud%20Gate%20crowd%20Millennium%20Park%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"commute plans changed fast after service notices went up.", source:"Google News", url:"https://news.google.com/search?q=CTA%20service%20disruption%20update%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"wind advisories put the lakefront in the headlines.", source:"Google News", url:"https://news.google.com/search?q=Chicago%20lakefront%20wind%20advisory%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a neighborhood food story had locals talking.", source:"Google News", url:"https://news.google.com/search?q=Chicago%20pizza%20spot%20opening%20buzz%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"San Francisco",
    lat:37.7749,lng:-122.4194,
    cards:[
      {emoji:"üåâ", clue:"Yesterday, fog and traffic warnings dominated the iconic crossing."},
      {emoji:"üöã", clue:"Yesterday, riders checked updates as streetcars and buses shifted service."},
      {emoji:"üíª", clue:"Yesterday, a tech headline put the city back in focus."},
      {emoji:"üßë‚Äçüç≥", clue:"Yesterday, a restaurant story sparked a line and a debate."}
    ],
    stories:[
      {headline:"fog and traffic warnings dominated the iconic crossing.", source:"Google News", url:"https://news.google.com/search?q=Golden%20Gate%20fog%20traffic%20advisory%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"riders checked updates as streetcars and buses shifted service.", source:"Google News", url:"https://news.google.com/search?q=Muni%20service%20advisory%20today%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a tech headline put the city back in focus.", source:"Google News", url:"https://news.google.com/search?q=San%20Francisco%20startup%20funding%20round%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a restaurant story sparked a line and a debate.", source:"Google News", url:"https://news.google.com/search?q=San%20Francisco%20restaurant%20opening%20controversy%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Los Angeles",
    lat:34.0522,lng:-118.2437,
    cards:[
      {emoji:"üé¨", clue:"Yesterday, a film or awards headline put Hollywood back on the radar."},
      {emoji:"üöó", clue:"Yesterday, a freeway incident rippled into hours of delays."},
      {emoji:"üèñÔ∏è", clue:"Yesterday, beach advisories changed weekend plans."},
      {emoji:"üèÄ", clue:"Yesterday, game night crowds filled streets near the arena."}
    ],
    stories:[
      {headline:"a film or awards headline put Hollywood back on the radar.", source:"Google News", url:"https://news.google.com/search?q=Hollywood%20awards%20news%20Los%20Angeles%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a freeway incident rippled into hours of delays.", source:"Google News", url:"https://news.google.com/search?q=Los%20Angeles%20freeway%20crash%20delays%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"beach advisories changed weekend plans.", source:"Google News", url:"https://news.google.com/search?q=Los%20Angeles%20beach%20water%20advisory%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"game night crowds filled streets near the arena.", source:"Google News", url:"https://news.google.com/search?q=LA%20arena%20game%20crowd%20downtown%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Seattle",
    lat:47.6062,lng:-122.3321,
    cards:[
      {emoji:"‚òïÔ∏è", clue:"Yesterday, a coffee story brewed up a citywide conversation."},
      {emoji:"üåßÔ∏è", clue:"Yesterday, rain and advisories slowed the commute."},
      {emoji:"üõ≥Ô∏è", clue:"Yesterday, riders watched ferry updates as routes shifted."},
      {emoji:"üé∏", clue:"Yesterday, a live‚Äëmusic night spilled into the streets."}
    ],
    stories:[
      {headline:"a coffee story brewed up a citywide conversation.", source:"Google News", url:"https://news.google.com/search?q=Seattle%20coffee%20prices%20new%20cafe%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"rain and advisories slowed the commute.", source:"Google News", url:"https://news.google.com/search?q=Seattle%20rain%20advisory%20commute%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"riders watched ferry updates as routes shifted.", source:"Google News", url:"https://news.google.com/search?q=Washington%20State%20Ferries%20delay%20update%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a live‚Äëmusic night spilled into the streets.", source:"Google News", url:"https://news.google.com/search?q=Seattle%20concert%20crowd%20neighborhood%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Miami",
    lat:25.7617,lng:-80.1918,
    cards:[
      {emoji:"üèñÔ∏è", clue:"Yesterday, beach crowds returned as conditions improved."},
      {emoji:"üå¥", clue:"Yesterday, heat or storm advisories reshaped plans."},
      {emoji:"üé®", clue:"Yesterday, new murals and art buzzed through a warehouse district."},
      {emoji:"‚öΩÔ∏è", clue:"Yesterday, a sports headline lit up the city‚Äôs feed."}
    ],
    stories:[
      {headline:"beach crowds returned as conditions improved.", source:"Google News", url:"https://news.google.com/search?q=Miami%20Beach%20conditions%20crowds%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"heat or storm advisories reshaped plans.", source:"Google News", url:"https://news.google.com/search?q=Miami%20weather%20advisory%20heat%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"new murals and art buzzed through a warehouse district.", source:"Google News", url:"https://news.google.com/search?q=Wynwood%20mural%20unveiling%20Miami%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a sports headline lit up the city‚Äôs feed.", source:"Google News", url:"https://news.google.com/search?q=Miami%20soccer%20match%20crowd%20news%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Dallas",
    lat:32.7767,lng:-96.797,
    cards:[
      {emoji:"‚úàÔ∏è", clue:"Yesterday, airport delays stacked up through the afternoon."},
      {emoji:"üöì", clue:"Yesterday, downtown closures rerouted drivers for hours."},
      {emoji:"üèà", clue:"Yesterday, stadium‚Äëdistrict buzz built ahead of a big event."},
      {emoji:"üå™Ô∏è", clue:"Yesterday, severe weather alerts kept eyes on the radar."}
    ],
    stories:[
      {headline:"airport delays stacked up through the afternoon.", source:"Google News", url:"https://news.google.com/search?q=DFW%20airport%20delays%20today%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"downtown closures rerouted drivers for hours.", source:"Google News", url:"https://news.google.com/search?q=Dallas%20road%20closures%20downtown%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"stadium‚Äëdistrict buzz built ahead of a big event.", source:"Google News", url:"https://news.google.com/search?q=Dallas%20stadium%20district%20event%20crowd%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"severe weather alerts kept eyes on the radar.", source:"Google News", url:"https://news.google.com/search?q=Dallas%20severe%20weather%20watch%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Houston",
    lat:29.7604,lng:-95.3698,
    cards:[
      {emoji:"‚ö°Ô∏è", clue:"Yesterday, storms sparked outage updates across neighborhoods."},
      {emoji:"üöß", clue:"Yesterday, construction closures squeezed a major commute route."},
      {emoji:"üèÄ", clue:"Yesterday, arena crowds packed the downtown blocks."},
      {emoji:"üöÄ", clue:"Yesterday, space‚Äëindustry news sparked a wave of local pride."}
    ],
    stories:[
      {headline:"storms sparked outage updates across neighborhoods.", source:"Google News", url:"https://news.google.com/search?q=Houston%20power%20outage%20storms%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"construction closures squeezed a major commute route.", source:"Google News", url:"https://news.google.com/search?q=Houston%20freeway%20closure%20construction%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"arena crowds packed the downtown blocks.", source:"Google News", url:"https://news.google.com/search?q=Houston%20downtown%20arena%20crowd%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"space‚Äëindustry news sparked a wave of local pride.", source:"Google News", url:"https://news.google.com/search?q=Houston%20NASA%20announcement%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Atlanta",
    lat:33.749,lng:-84.388,
    cards:[
      {emoji:"‚úàÔ∏è", clue:"Yesterday, flight boards filled with delays at a major hub."},
      {emoji:"üöá", clue:"Yesterday, rail riders adapted to service changes."},
      {emoji:"üé§", clue:"Yesterday, a concert night turned downtown into a crowd."},
      {emoji:"üçó", clue:"Yesterday, a food story had locals arguing about the best bite."}
    ],
    stories:[
      {headline:"flight boards filled with delays at a major hub.", source:"Google News", url:"https://news.google.com/search?q=ATL%20airport%20delays%20cancellations%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"rail riders adapted to service changes.", source:"Google News", url:"https://news.google.com/search?q=MARTA%20service%20changes%20today%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a concert night turned downtown into a crowd.", source:"Google News", url:"https://news.google.com/search?q=Atlanta%20concert%20crowd%20downtown%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a food story had locals arguing about the best bite.", source:"Google News", url:"https://news.google.com/search?q=Atlanta%20fried%20chicken%20new%20spot%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Denver",
    lat:39.7392,lng:-104.9903,
    cards:[
      {emoji:"‚ùÑÔ∏è", clue:"Yesterday, winter weather warnings reshaped the morning commute."},
      {emoji:"‚õ∑Ô∏è", clue:"Yesterday, mountain traffic piled up as weekend plans kicked off."},
      {emoji:"üèÄ", clue:"Yesterday, a downtown event filled restaurants and sidewalks."},
      {emoji:"üå≤", clue:"Yesterday, trail and park updates shifted outdoor plans."}
    ],
    stories:[
      {headline:"winter weather warnings reshaped the morning commute.", source:"Google News", url:"https://news.google.com/search?q=Denver%20snow%20advisory%20commute%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"mountain traffic piled up as weekend plans kicked off.", source:"Google News", url:"https://news.google.com/search?q=I-70%20ski%20traffic%20Denver%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a downtown event filled restaurants and sidewalks.", source:"Google News", url:"https://news.google.com/search?q=Denver%20downtown%20event%20crowd%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"trail and park updates shifted outdoor plans.", source:"Google News", url:"https://news.google.com/search?q=Denver%20trail%20closure%20update%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Phoenix",
    lat:33.4484,lng:-112.074,
    cards:[
      {emoji:"üî•", clue:"Yesterday, fire‚Äëweather conditions prompted alerts."},
      {emoji:"üöß", clue:"Yesterday, a freeway closure rerouted drivers into surface streets."},
      {emoji:"üèÄ", clue:"Yesterday, game crowds filled downtown blocks."},
      {emoji:"üåµ", clue:"Yesterday, desert recreation news brought fresh guidance."}
    ],
    stories:[
      {headline:"fire‚Äëweather conditions prompted alerts.", source:"Google News", url:"https://news.google.com/search?q=Phoenix%20fire%20weather%20alert%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a freeway closure rerouted drivers into surface streets.", source:"Google News", url:"https://news.google.com/search?q=Phoenix%20freeway%20closure%20detour%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"game crowds filled downtown blocks.", source:"Google News", url:"https://news.google.com/search?q=Phoenix%20game%20crowd%20downtown%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"desert recreation news brought fresh guidance.", source:"Google News", url:"https://news.google.com/search?q=Phoenix%20hiking%20advisory%20heat%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Las Vegas",
    lat:36.1699,lng:-115.1398,
    cards:[
      {emoji:"üé∞", clue:"Yesterday, late‚Äënight foot traffic surged along the Strip."},
      {emoji:"üé§", clue:"Yesterday, a major show drew huge lines outside an arena."},
      {emoji:"üöß", clue:"Yesterday, detours popped up near a large event."},
      {emoji:"üèüÔ∏è", clue:"Yesterday, a stadium headline drove a spike in rideshares."}
    ],
    stories:[
      {headline:"late‚Äënight foot traffic surged along the Strip.", source:"Google News", url:"https://news.google.com/search?q=Las%20Vegas%20Strip%20crowds%20night%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a major show drew huge lines outside an arena.", source:"Google News", url:"https://news.google.com/search?q=Las%20Vegas%20concert%20arena%20lines%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"detours popped up near a large event.", source:"Google News", url:"https://news.google.com/search?q=Las%20Vegas%20road%20closures%20event%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a stadium headline drove a spike in rideshares.", source:"Google News", url:"https://news.google.com/search?q=Las%20Vegas%20stadium%20event%20rideshare%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"New Orleans",
    lat:29.9511,lng:-90.0715,
    cards:[
      {emoji:"üé∫", clue:"Yesterday, live music spilled onto a crowded corner."},
      {emoji:"üé≠", clue:"Yesterday, parade logistics reshaped traffic for blocks."},
      {emoji:"üåßÔ∏è", clue:"Yesterday, heavy rain brought street‚Äëflooding updates."},
      {emoji:"üç§", clue:"Yesterday, a food festival story had locals lining up."}
    ],
    stories:[
      {headline:"live music spilled onto a crowded corner.", source:"Google News", url:"https://news.google.com/search?q=French%20Quarter%20live%20jazz%20crowd%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"parade logistics reshaped traffic for blocks.", source:"Google News", url:"https://news.google.com/search?q=New%20Orleans%20parade%20route%20traffic%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"heavy rain brought street‚Äëflooding updates.", source:"Google News", url:"https://news.google.com/search?q=New%20Orleans%20street%20flooding%20rain%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a food festival story had locals lining up.", source:"Google News", url:"https://news.google.com/search?q=New%20Orleans%20food%20festival%20line%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Toronto",
    lat:43.6532,lng:-79.3832,
    cards:[
      {emoji:"üöá", clue:"Yesterday, transit notices changed routes across the city."},
      {emoji:"üèí", clue:"Yesterday, a game night packed bars and trains."},
      {emoji:"üå®Ô∏è", clue:"Yesterday, snow cleanup and advisories dominated local updates."},
      {emoji:"üèôÔ∏è", clue:"Yesterday, a downtown event kept streets busy late."}
    ],
    stories:[
      {headline:"transit notices changed routes across the city.", source:"Google News", url:"https://news.google.com/search?q=TTC%20service%20disruption%20Toronto%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a game night packed bars and trains.", source:"Google News", url:"https://news.google.com/search?q=Toronto%20game%20night%20crowds%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"snow cleanup and advisories dominated local updates.", source:"Google News", url:"https://news.google.com/search?q=Toronto%20snow%20advisory%20cleanup%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a downtown event kept streets busy late.", source:"Google News", url:"https://news.google.com/search?q=Toronto%20downtown%20event%20crowd%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"London",
    lat:51.5074,lng:-0.1278,
    cards:[
      {emoji:"üöá", clue:"Yesterday, disruptions rippled through the Underground."},
      {emoji:"‚öΩÔ∏è", clue:"Yesterday, matchday crowds turned streets into rivers."},
      {emoji:"üèõÔ∏è", clue:"Yesterday, a major vote kept Parliament in the headlines."},
      {emoji:"üõ´", clue:"Yesterday, travelers tracked delays at a major airport."}
    ],
    stories:[
      {headline:"disruptions rippled through the Underground.", source:"Google News", url:"https://news.google.com/search?q=London%20Underground%20disruption%20today%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"matchday crowds turned streets into rivers.", source:"Google News", url:"https://news.google.com/search?q=London%20matchday%20crowds%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a major vote kept Parliament in the headlines.", source:"Google News", url:"https://news.google.com/search?q=UK%20Parliament%20vote%20today%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"travelers tracked delays at a major airport.", source:"Google News", url:"https://news.google.com/search?q=Heathrow%20delays%20cancellations%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Paris",
    lat:48.8566,lng:2.3522,
    cards:[
      {emoji:"üöá", clue:"Yesterday, Metro updates reshaped commutes across lines."},
      {emoji:"üóº", clue:"Yesterday, security queues lengthened near a famous landmark."},
      {emoji:"üé®", clue:"Yesterday, museum crowds surged for a popular exhibit."},
      {emoji:"‚öΩÔ∏è", clue:"Yesterday, a big match pushed nightlife late into the night."}
    ],
    stories:[
      {headline:"Metro updates reshaped commutes across lines.", source:"Google News", url:"https://news.google.com/search?q=Paris%20Metro%20disruption%20today%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"security queues lengthened near a famous landmark.", source:"Google News", url:"https://news.google.com/search?q=Eiffel%20Tower%20security%20lines%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"museum crowds surged for a popular exhibit.", source:"Google News", url:"https://news.google.com/search?q=Paris%20museum%20exhibit%20crowd%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a big match pushed nightlife late into the night.", source:"Google News", url:"https://news.google.com/search?q=Paris%20match%20crowd%20nightlife%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Tokyo",
    lat:35.6762,lng:139.6503,
    cards:[
      {emoji:"üöâ", clue:"Yesterday, station crowds surged at peak hour."},
      {emoji:"üå∏", clue:"Yesterday, early signs of blossom season drew attention."},
      {emoji:"üåÄ", clue:"Yesterday, weather alerts shaped schedules across the city."},
      {emoji:"üçú", clue:"Yesterday, a food trend sent people lining up for noodles."}
    ],
    stories:[
      {headline:"station crowds surged at peak hour.", source:"Google News", url:"https://news.google.com/search?q=Shinjuku%20Station%20crowd%20rush%20hour%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"early signs of blossom season drew attention.", source:"Google News", url:"https://news.google.com/search?q=Tokyo%20early%20cherry%20blossom%20report%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"weather alerts shaped schedules across the city.", source:"Google News", url:"https://news.google.com/search?q=Tokyo%20weather%20alert%20transit%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"a food trend sent people lining up for noodles.", source:"Google News", url:"https://news.google.com/search?q=Tokyo%20ramen%20line%20new%20shop%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  },
  {
    city:"Sydney",
    lat:-33.8688,lng:151.2093,
    cards:[
      {emoji:"üéº", clue:"Yesterday, a harbor‚Äëside performance drew an evening crowd."},
      {emoji:"üåâ", clue:"Yesterday, traffic slowed near an iconic bridge approach."},
      {emoji:"üèñÔ∏è", clue:"Yesterday, surf conditions triggered warnings and flags."},
      {emoji:"üî•", clue:"Yesterday, heat or fire updates prompted public guidance."}
    ],
    stories:[
      {headline:"a harbor‚Äëside performance drew an evening crowd.", source:"Google News", url:"https://news.google.com/search?q=Sydney%20Opera%20House%20performance%20crowd%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"traffic slowed near an iconic bridge approach.", source:"Google News", url:"https://news.google.com/search?q=Sydney%20Harbour%20Bridge%20traffic%20delay%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"surf conditions triggered warnings and flags.", source:"Google News", url:"https://news.google.com/search?q=Bondi%20surf%20conditions%20warning%20when%3A14d&hl=en-US&gl=US&ceid=US:en"},
      {headline:"heat or fire updates prompted public guidance.", source:"Google News", url:"https://news.google.com/search?q=Sydney%20heat%20warning%20update%20when%3A14d&hl=en-US&gl=US&ceid=US:en"}
    ]
  }
];
// ----- Build today's puzzle: choose a city pack deterministically & ensure different from yesterday -----
function ymdOffset(key, deltaDays){
  const d = new Date(key+"T00:00:00Z");
  d.setUTCDate(d.getUTCDate()+deltaDays);
  return d.toISOString().slice(0,10);
}
function pickPack(key){
  const r = makeRand(hashDate(key) ^ 0xBEEFCAFE);
  return Math.floor(r()*CITY_PACKS.length);
}
let packIndex = pickPack(dayKey);
// rotate to a new city today (testing)
packIndex = (packIndex + 9) % CITY_PACKS.length;
const yIndex = pickPack(ymdOffset(dayKey,-1));
if (packIndex === yIndex) packIndex = (packIndex + 1) % CITY_PACKS.length;

const PACK = CITY_PACKS[packIndex];
const answer = {name:PACK.city, lat:PACK.lat, lng:PACK.lng};
const chosenCards = PACK.cards;
const chosenStories = PACK.stories;

// ----- render clue cards -----
const grid=document.getElementById("grid");
chosenCards.forEach((c,i)=>{
  const d=document.createElement("div");
  d.className="flip";
  d.innerHTML = `
    <div class="flipInner">
      <div class="face front">
        <div class="emojiFront">${c.emoji || "üóûÔ∏è"}</div>
        <div class="veil"></div>
        <div class="tag">Clue ${i+1}</div>
      </div>
      <div class="face back"><p>${c.clue}</p></div>
    </div>`;
  d.onclick=()=>d.dataset.flipped=d.dataset.flipped==="true"?"false":"true";
  grid.appendChild(d);
});

// ----- gameplay -----
function toRad(d){return d*Math.PI/180;}
function miles(a,b,c,d){
  const R=3958.8;
  const dLat=toRad(c-a), dLon=toRad(d-b);
  const q=Math.sin(dLat/2)**2 + Math.cos(toRad(a))*Math.cos(toRad(c))*Math.sin(dLon/2)**2;
  return Math.round(R*2*Math.atan2(Math.sqrt(q),Math.sqrt(1-q)));
}

let guesses=[]; const MAX=5;
const count=document.getElementById("count");
const feedback=document.getElementById("feedback");
const error=document.getElementById("error");
function updateCount(){count.textContent=guesses.length+"/"+MAX+" guesses";}

function normalizeGuess(raw){
  let s=(raw||"").trim().toLowerCase();
  s=s.replace(/\./g,"");
  if(ALIASES[s]) return ALIASES[s].toLowerCase();
  return s;
}

function findCity(q){
  const s=normalizeGuess(q);
  if(!s) return null;
  return CITIES.find(c=>c.name.toLowerCase()===s) || CITIES.find(c=>c.name.toLowerCase().startsWith(s)) || null;
}

document.getElementById("submitBtn").onclick=submitGuess;
document.getElementById("guessInput").addEventListener("keydown",(e)=>{ if(e.key==="Enter") submitGuess(); });
document.getElementById("revealBtn").onclick=()=>finish(false);

function submitGuess(){
  error.style.display="none";
  if(guesses.length>=MAX) return;

  const val=document.getElementById("guessInput").value;
  const found=findCity(val);
  if(!found){ error.style.display="block"; return; }

  const d=miles(found.lat,found.lng,answer.lat,answer.lng);
  guesses.push(d);
  feedback.style.display="block";
  feedback.textContent = found.name+" is "+d+" miles away.";
  updateCount();

  if(found.name===answer.name || guesses.length>=MAX) finish(found.name===answer.name);
  document.getElementById("guessInput").value="";
}

function heat(m){ if(m===0) return "üü¶"; if(m<250) return "üü©"; if(m<900) return "üü®"; if(m<2000) return "üüß"; return "‚¨õ"; }

// ----- stats (compact) -----
function getStats(){
  return JSON.parse(localStorage.getItem("y_stats")||'{"played":0,"wins":0,"cur":0,"max":0,"lastWin":""}');
}
function saveStats(s){ localStorage.setItem("y_stats",JSON.stringify(s)); }

function finish(win){
  if(document.getElementById("modal").style.display==="flex") return;

  const s=getStats();
  const key = "y_done_"+dayKey;
  const alreadyDone = localStorage.getItem(key)==="1";
  if(!alreadyDone){
    s.played++;
    if(win){
      s.wins++;
      const last = s.lastWin ? new Date(s.lastWin) : null;
      const diff = last ? (new Date(dayKey)-last)/86400000 : 999;
      s.cur = (diff===1) ? (s.cur+1) : 1;
      s.max = Math.max(s.max, s.cur);
      s.lastWin = dayKey;
    }else{
      s.cur=0;
    }
    saveStats(s);
    localStorage.setItem(key,"1");
  }

  const storyEmojis = chosenCards.map(c=>c.emoji).join("");
  const boxes = guesses.map(heat).join("");
  const text = `YESTERDAY ${dayKey}\n${storyEmojis}\n${boxes}\n${win?"Solved":"Revealed"} ${guesses.length}/${MAX}\nhttps://dcmetrocentric.github.io/yesterday/`;

  document.getElementById("modal").style.display="flex";
  document.getElementById("resultTitle").textContent = win ? "Solved!" : "Revealed";
  document.getElementById("answerLine").textContent = "Answer: " + answer.name;

  const winPct = s.played ? Math.round((s.wins/s.played)*100) : 0;
  document.getElementById("miniStats").textContent = `Streak ${s.cur||0} ‚Ä¢ Max ${s.max||0} ‚Ä¢ Played ${s.played} ‚Ä¢ Win ${winPct}%`;
  document.getElementById("shareBox").textContent = text;

  // render stories (titles only)
  const stories=document.getElementById("stories");
  stories.innerHTML="";
  chosenStories.forEach((st)=>{
    const el=document.createElement("div");
    el.className="fpItem";
    el.innerHTML = `<a href="${st.url}" target="_blank" rel="noopener noreferrer">
        <div class="fpTitle">${st.headline}</div>
        <div class="fpSource">${st.source}</div>
      </a>`;
    stories.appendChild(el);
  });
}

// share -> native share sheet or SMS compose
document.getElementById("shareBtn").onclick=async()=>{
  const text=document.getElementById("shareBox").textContent;
  if(navigator.share){ try{ await navigator.share({text}); return; }catch(e){} }
  window.location.href="sms:?&body="+encodeURIComponent(text);
};

updateCount();
</script>
</body>
</html>
